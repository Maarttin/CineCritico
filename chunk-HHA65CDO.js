import{a as X,c as Y,e as ee,f as ne,g as O,i as te,j as ie,k as re}from"./chunk-S7W4SSN2.js";import{a as j,c as $,f as H,h as G,i as Z,l as J,m as K,p as Q}from"./chunk-GSFLE64X.js";import{$ as C,A as o,C as T,D as V,H as m,M as d,N as s,O as t,P as w,Q as u,R as f,S as P,T as x,U as c,V as k,X as a,Y as b,Z as E,_ as M,a as R,aa as v,ca as I,ea as S,fa as F,fb as U,ga as N,ha as W,o as h,oa as D,pa as L,qa as A,r as p,ra as z,s as g,sa as B,z as y,za as q}from"./chunk-FWRNMML4.js";function oe(n,i){if(n&1&&(u(0),w(1,"img",13),s(2,"p")(3,"strong"),a(4,"Pel\xEDcula: "),t(),a(5),t(),f()),n&2){let e=c(2).$implicit;o(),d("alt",I("P\xF3ster de ",e.peliculaNombre))("src","https://image.tmdb.org/t/p/w500"+e.posterPath,y),o(4),b(e.peliculaNombre)}}function se(n,i){if(n&1&&w(0,"img",13),n&2){let e=c(3).$implicit;d("alt",I("Portada de ",e.peliculaNombre))("src",e.posterPath,y)}}function le(n,i){if(n&1&&(s(0,"p")(1,"strong"),a(2,"Autor: "),t(),a(3),t()),n&2){let e=c(3).$implicit;o(3),b(e.autor)}}function ce(n,i){if(n&1&&(u(0),m(1,se,1,3,"img",14),s(2,"p")(3,"strong"),a(4,"Libro: "),t(),a(5),t(),m(6,le,4,1,"p",9),f()),n&2){let e=c(2).$implicit;o(),d("ngIf",e.posterPath),o(4),b(e.peliculaNombre),o(),d("ngIf",e.autor)}}function _e(n,i){if(n&1){let e=P();s(0,"div",15)(1,"div",16)(2,"h3"),a(3,"Editar rese\xF1a"),t(),s(4,"textarea",17),v("ngModelChange",function(l){p(e);let _=c(5);return C(_.resenaEditando.comentario,l)||(_.resenaEditando.comentario=l),g(l)}),t(),s(5,"input",18),v("ngModelChange",function(l){p(e);let _=c(5);return C(_.resenaEditando.calificacion,l)||(_.resenaEditando.calificacion=l),g(l)}),t(),s(6,"div",19)(7,"button",11),x("click",function(){p(e);let l=c(5);return g(l.guardarEdicion())}),a(8,"Guardar"),t(),s(9,"button",11),x("click",function(){p(e);let l=c(5);return g(l.cancelarEdicion())}),a(10,"Cancelar"),t()()()()}if(n&2){let e=c(5);o(4),M("ngModel",e.resenaEditando.comentario),o(),M("ngModel",e.resenaEditando.calificacion)}}function de(n,i){if(n&1){let e=P();u(0),s(1,"div",10),m(2,oe,6,4,"ng-container",9)(3,ce,7,3,"ng-container",9),s(4,"p")(5,"strong"),a(6,"Calificaci\xF3n: "),t(),a(7),t(),s(8,"p")(9,"strong"),a(10,"Usted ha escrito:"),t(),a(11),t(),s(12,"small"),a(13),S(14,"date"),t(),s(15,"button",11),x("click",function(){p(e);let l=c().$implicit,_=c(3);return g(_.editarResena(l))}),a(16,"Editar"),t(),s(17,"button",11),x("click",function(){p(e);let l=c().$implicit,_=c(3);return g(_.eliminarResena(l.id))}),a(18,"Eliminar"),t(),m(19,_e,11,2,"div",12),t(),f()}if(n&2){let e=c().$implicit,r=c(3);o(2),d("ngIf",e.tipo==="pelicula"),o(),d("ngIf",e.tipo==="libro"),o(4),E("",e.calificacion,"/10"),o(4),E(" ",e.comentario),o(2),E("Fecha de la rese\xF1a: ",N(14,6,e.fecha,"medium")),o(6),d("ngIf",(r.resenaEditando==null?null:r.resenaEditando.id)===e.id)}}function me(n,i){if(n&1&&(u(0),m(1,de,20,9,"ng-container",9),f()),n&2){let e=i.$implicit,r=c(3);o(),d("ngIf",e.tipo===r.tipoResena)}}function pe(n,i){if(n&1&&(u(0),m(1,me,2,1,"ng-container",8),f()),n&2){let e=c().ngIf;o(),d("ngForOf",e)}}function ge(n,i){n&1&&(s(0,"p"),a(1,"No hay rese\xF1as disponibles."),t())}function ue(n,i){if(n&1&&(s(0,"div",6),m(1,pe,2,1,"ng-container",7)(2,ge,2,0,"ng-template",null,0,W),t()),n&2){let e=i.ngIf,r=k(3);o(),d("ngIf",e.length>0)("ngIfElse",r)}}var ae=class n{constructor(i){this.router=i}firestore=h(X);auth=h(U);resenas=[];resenas$;mostrarLibros=!1;mostrarPeliculas=!1;tipoResena="libro";async ngOnInit(){let i=this.auth.currentUser;if(!i)return;let e=ee(this.firestore,"resenas"),r=te(e,re("usuarioId","==",i.uid));this.resenas$=Y(r,{idField:"id"})}setTipoResena(i){i==="libro"?(this.mostrarLibros=!0,this.mostrarPeliculas=!1):(this.mostrarLibros=!1,this.mostrarPeliculas=!0)}irAHome(){this.router.navigate(["/home"])}resenaEditando=null;editarResena(i){this.resenaEditando=R({},i)}cancelarEdicion(){this.resenaEditando=null}async guardarEdicion(){let i=O(this.firestore,"resenas",this.resenaEditando.id);await ie(i,{comentario:this.resenaEditando.comentario,calificacion:this.resenaEditando.calificacion}),this.resenaEditando=null}eliminarResena(i){if(!confirm("\xBFSeguro que quieres eliminar esta rese\xF1a?"))return;let e=O(this.firestore,"resenas",i);ne(e)}static \u0275fac=function(e){return new(e||n)(T(q))};static \u0275cmp=V({type:n,selectors:[["app-misresenas"]],decls:13,vars:5,consts:[["sinResenas",""],[1,"volver",3,"click"],[1,"filtros"],["type","radio","name","tipoResena","value","libro",3,"ngModelChange","ngModel"],["type","radio","name","tipoResena","value","pelicula",3,"ngModelChange","ngModel"],["class","resenas",4,"ngIf"],[1,"resenas"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"resena"],[3,"click"],["class","modal",4,"ngIf"],[3,"src","alt"],[3,"src","alt",4,"ngIf"],[1,"modal"],[1,"modal-content"],["rows","4",3,"ngModelChange","ngModel"],["type","number","min","1","max","10",3,"ngModelChange","ngModel"],[1,"modal-actions"]],template:function(e,r){e&1&&(s(0,"h2"),a(1,"Mis comentarios"),t(),s(2,"button",1),x("click",function(){return r.irAHome()}),a(3,"Volver"),t(),s(4,"div",2)(5,"label")(6,"input",3),v("ngModelChange",function(_){return C(r.tipoResena,_)||(r.tipoResena=_),_}),t(),a(7," Libros "),t(),s(8,"label")(9,"input",4),v("ngModelChange",function(_){return C(r.tipoResena,_)||(r.tipoResena=_),_}),t(),a(10," Pel\xEDculas "),t()(),m(11,ue,4,2,"div",5),S(12,"async")),e&2&&(o(6),M("ngModel",r.tipoResena),o(3),M("ngModel",r.tipoResena),o(2),d("ngIf",F(12,3,r.resenas$)))},dependencies:[B,D,L,Q,j,G,Z,$,K,J,H,A,z],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}[_nghost-%COMP%]{display:block;padding:1rem}h2[_ngcontent-%COMP%]{text-align:center;margin:0 0 1rem;font-size:1.4rem}.volver[_ngcontent-%COMP%]{display:inline-block;margin-bottom:1rem;padding:.5rem .9rem;border:1px solid #ccc;border-radius:6px;background:#f7f7f7;cursor:pointer}.resenas[_ngcontent-%COMP%]{width:100%;max-width:700px;margin:0 auto}.resena[_ngcontent-%COMP%]{width:100%;padding:.75rem 0;border-bottom:1px solid #eaeaea}.resena[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;color:#333;overflow-wrap:anywhere;word-break:break-word}.resena[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;margin-top:.25rem;color:#666;font-size:.85rem}.empty[_ngcontent-%COMP%]{text-align:center;color:#666;font-style:italic;margin-top:1rem}@media (max-width: 480px){[_nghost-%COMP%]{padding:.75rem}h2[_ngcontent-%COMP%]{font-size:1.2rem}}img[_ngcontent-%COMP%]{display:block;margin:0 auto;width:160px;height:240px;object-fit:cover;border-radius:8px;margin-top:1rem}"]})};export{ae as Misresenas};
