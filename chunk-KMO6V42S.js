import{a as X,c as Y,e as ee,f as te,g as R,i as ne,j as ie,k as re}from"./chunk-S7W4SSN2.js";import{a as q,c as H,f as $,h as G,i as Z,l as J,m as K,p as Q}from"./chunk-GSFLE64X.js";import{$ as v,A as a,C as V,D as k,H as m,M as d,N as s,O as i,P as w,Q as f,R as x,S as P,T as u,U as c,V as I,X as o,Y as b,Z as h,_ as C,a as O,aa as M,ca as S,ea as T,fa as F,fb as j,ga as N,ha as D,o as E,oa as W,pa as A,qa as L,r as p,ra as z,s as g,sa as B,z as y,za as U}from"./chunk-FWRNMML4.js";function oe(t,n){if(t&1&&(s(0,"h3"),o(1),i()),t&2){let e=c(3);a(),h("Usted ha comentado ",e.getCantidadPorTipo("libro")," libros")}}function se(t,n){if(t&1&&(s(0,"h3"),o(1),i()),t&2){let e=c(3);a(),h("Usted ha comentado ",e.getCantidadPorTipo("pelicula")," pel\xEDculas")}}function le(t,n){if(t&1&&(f(0),w(1,"img",14),s(2,"p")(3,"strong"),o(4,"Pel\xEDcula: "),i(),o(5),i(),x()),t&2){let e=c(2).$implicit;a(),d("alt",S("P\xF3ster de ",e.peliculaNombre))("src","https://image.tmdb.org/t/p/w500"+e.posterPath,y),a(4),b(e.peliculaNombre)}}function ce(t,n){if(t&1&&w(0,"img",14),t&2){let e=c(3).$implicit;d("alt",S("Portada de ",e.peliculaNombre))("src",e.posterPath,y)}}function _e(t,n){if(t&1&&(s(0,"p")(1,"strong"),o(2,"Autor: "),i(),o(3),i()),t&2){let e=c(3).$implicit;a(3),b(e.autor)}}function de(t,n){if(t&1&&(f(0),m(1,ce,1,3,"img",15),s(2,"p")(3,"strong"),o(4,"Libro: "),i(),o(5),i(),m(6,_e,4,1,"p",9),x()),t&2){let e=c(2).$implicit;a(),d("ngIf",e.posterPath),a(4),b(e.peliculaNombre),a(),d("ngIf",e.autor)}}function me(t,n){if(t&1){let e=P();s(0,"div",16)(1,"div",17)(2,"h3"),o(3,"Editar comentario"),i(),s(4,"textarea",18,1),M("ngModelChange",function(l){p(e);let _=c(5);return v(_.resenaEditando.comentario,l)||(_.resenaEditando.comentario=l),g(l)}),u("input",function(){p(e);let l=I(5),_=c(5);return g(_.ajustarAltura(l))}),i(),s(6,"h3"),o(7,"Calificaci\xF3n"),i(),s(8,"input",19),M("ngModelChange",function(l){p(e);let _=c(5);return v(_.resenaEditando.calificacion,l)||(_.resenaEditando.calificacion=l),g(l)}),i(),s(9,"div",20)(10,"button",12),u("click",function(){p(e);let l=c(5);return g(l.guardarEdicion())}),o(11,"Guardar"),i(),s(12,"button",12),u("click",function(){p(e);let l=c(5);return g(l.cancelarEdicion())}),o(13,"Cancelar"),i()()()()}if(t&2){let e=c(5);a(4),C("ngModel",e.resenaEditando.comentario),a(4),C("ngModel",e.resenaEditando.calificacion)}}function pe(t,n){if(t&1){let e=P();f(0),s(1,"div",11),m(2,le,6,4,"ng-container",9)(3,de,7,3,"ng-container",9),s(4,"p")(5,"strong"),o(6,"Calificaci\xF3n: "),i(),o(7),i(),s(8,"p")(9,"strong"),o(10,"Usted ha escrito:"),i(),o(11),i(),s(12,"small"),o(13),T(14,"date"),i(),s(15,"button",12),u("click",function(){p(e);let l=c().$implicit,_=c(3);return g(_.editarResena(l))}),o(16,"Editar"),i(),s(17,"button",12),u("click",function(){p(e);let l=c().$implicit,_=c(3);return g(_.eliminarResena(l.id))}),o(18,"Eliminar"),i(),m(19,me,14,2,"div",13),i(),x()}if(t&2){let e=c().$implicit,r=c(3);a(2),d("ngIf",e.tipo==="pelicula"),a(),d("ngIf",e.tipo==="libro"),a(4),h("",e.calificacion,"/10"),a(4),h(" ",e.comentario),a(2),h("Fecha de la rese\xF1a: ",N(14,6,e.fecha,"medium")),a(6),d("ngIf",(r.resenaEditando==null?null:r.resenaEditando.id)===e.id)}}function ge(t,n){if(t&1&&(f(0),m(1,pe,20,9,"ng-container",9),x()),t&2){let e=n.$implicit,r=c(3);a(),d("ngIf",e.tipo===r.tipoResena)}}function ue(t,n){if(t&1&&(f(0),m(1,oe,2,1,"h3",9)(2,se,2,1,"h3",9)(3,ge,2,1,"ng-container",10),x()),t&2){let e=c().ngIf,r=c();a(),d("ngIf",r.tipoResena==="libro"),a(),d("ngIf",r.tipoResena==="pelicula"),a(),d("ngForOf",e)}}function fe(t,n){t&1&&(s(0,"p"),o(1,"No hay rese\xF1as disponibles."),i())}function xe(t,n){if(t&1&&(s(0,"div",7),m(1,ue,4,3,"ng-container",8)(2,fe,2,0,"ng-template",null,0,D),i()),t&2){let e=n.ngIf,r=I(3);a(),d("ngIf",e.length>0)("ngIfElse",r)}}var ae=class t{constructor(n){this.router=n}firestore=E(X);auth=E(j);resenas=[];resenas$;mostrarLibros=!1;mostrarPeliculas=!1;tipoResena="libro";async ngOnInit(){let n=this.auth.currentUser;if(!n)return;let e=ee(this.firestore,"resenas"),r=ne(e,re("usuarioId","==",n.uid));this.resenas$=Y(r,{idField:"id"}),this.resenas$.subscribe(l=>{this.resenas=l})}setTipoResena(n){n==="libro"?(this.mostrarLibros=!0,this.mostrarPeliculas=!1):(this.mostrarLibros=!1,this.mostrarPeliculas=!0)}irAHome(){this.router.navigate(["/home"])}resenaEditando=null;editarResena(n){this.resenaEditando=O({},n)}cancelarEdicion(){this.resenaEditando=null}async guardarEdicion(){let n=R(this.firestore,"resenas",this.resenaEditando.id);await ie(n,{comentario:this.resenaEditando.comentario,calificacion:this.resenaEditando.calificacion}),this.resenaEditando=null}eliminarResena(n){if(!confirm("\xBFSeguro que quieres eliminar esta rese\xF1a?"))return;let e=R(this.firestore,"resenas",n);te(e)}getCantidadPorTipo(n){return this.resenas.filter(e=>e.tipo===n).length}ajustarAltura(n){n.style.height="auto",n.style.height=n.scrollHeight+"px"}static \u0275fac=function(e){return new(e||t)(V(U))};static \u0275cmp=k({type:t,selectors:[["app-misresenas"]],decls:13,vars:5,consts:[["sinResenas",""],["autoResize",""],[1,"volver",3,"click"],[1,"filtros"],["type","radio","name","tipoResena","value","libro",3,"ngModelChange","ngModel"],["type","radio","name","tipoResena","value","pelicula",3,"ngModelChange","ngModel"],["class","resenas",4,"ngIf"],[1,"resenas"],[4,"ngIf","ngIfElse"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"resena"],[1,"edit",3,"click"],["class","modal",4,"ngIf"],[3,"src","alt"],[3,"src","alt",4,"ngIf"],[1,"modal"],[1,"modal-content"],["rows","3",2,"overflow","hidden","resize","none","min-height","2.5em","line-height","1.5",3,"ngModelChange","input","ngModel"],["type","number","min","1","max","10",3,"ngModelChange","ngModel"],[1,"modal-actions"]],template:function(e,r){e&1&&(s(0,"h2"),o(1,"Mis comentarios"),i(),s(2,"button",2),u("click",function(){return r.irAHome()}),o(3,"Volver"),i(),s(4,"div",3)(5,"label")(6,"input",4),M("ngModelChange",function(_){return v(r.tipoResena,_)||(r.tipoResena=_),_}),i(),o(7," Libros "),i(),s(8,"label")(9,"input",5),M("ngModelChange",function(_){return v(r.tipoResena,_)||(r.tipoResena=_),_}),i(),o(10," Pel\xEDculas "),i()(),m(11,xe,4,2,"div",6),T(12,"async")),e&2&&(a(6),C("ngModel",r.tipoResena),a(3),C("ngModel",r.tipoResena),a(2),d("ngIf",F(12,3,r.resenas$)))},dependencies:[B,W,A,Q,q,G,Z,H,K,J,$,L,z],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}[_nghost-%COMP%]{display:block;padding:1rem}h2[_ngcontent-%COMP%]{text-align:center;margin:0 0 1rem;font-size:1.4rem}.volver[_ngcontent-%COMP%], .edit[_ngcontent-%COMP%]{display:inline-block;margin-bottom:1rem;padding:.5rem .9rem;border:1px solid #ccc;border-radius:6px;background:#f7f7f7;cursor:pointer}.resenas[_ngcontent-%COMP%]{width:100%;max-width:700px;margin:0 auto}.resena[_ngcontent-%COMP%]{width:100%;padding:.75rem 0;border-bottom:1px solid #eaeaea}.resena[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;color:#333;overflow-wrap:anywhere;word-break:break-word}.resena[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;margin-top:.25rem;color:#666;font-size:.85rem}.empty[_ngcontent-%COMP%]{text-align:center;color:#666;font-style:italic;margin-top:1rem}@media (max-width: 480px){[_nghost-%COMP%]{padding:.75rem}h2[_ngcontent-%COMP%]{font-size:1.2rem}}img[_ngcontent-%COMP%]{display:block;margin:0 auto;width:160px;height:240px;object-fit:cover;border-radius:8px;margin-top:1rem}"]})};export{ae as Misresenas};
