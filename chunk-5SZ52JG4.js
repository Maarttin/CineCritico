import{a as X,c as Y,e as ee,f as te,g as b,i as ne,j as ie,k as re}from"./chunk-S7W4SSN2.js";import{a as L,c as Z,f as $,h as G,k as J,l as K,o as Q}from"./chunk-L5ZPA45I.js";import{$ as v,A as c,C as O,D as P,H as u,J as I,M as _,N as r,O as t,P as V,Q as S,R as k,S as x,T as g,U as d,V as F,X as o,Y as N,Z as M,_ as h,a as w,aa as C,ca as T,ea as E,fa as R,fb as H,ga as D,ha as A,o as f,oa as W,pa as z,qa as q,r as m,ra as B,s as p,sa as U,z as y,za as j}from"./chunk-FWRNMML4.js";function oe(a,n){if(a&1){let e=x();r(0,"div",7),V(1,"img",8),r(2,"p")(3,"strong"),o(4,"Pel\xEDcula: "),t(),o(5),t(),r(6,"p")(7,"strong"),o(8,"Calificaci\xF3n: "),t(),o(9),t(),r(10,"p")(11,"strong"),o(12,"Usted ha escrito:"),t(),o(13),t(),r(14,"small"),o(15),E(16,"date"),t(),r(17,"button",9),g("click",function(){let i=m(e).$implicit,l=d(3);return p(l.editarResena(i))}),o(18,"Editar"),t(),r(19,"button",9),g("click",function(){let i=m(e).$implicit,l=d(3);return p(l.eliminarResena(i.id))}),o(20,"Eliminar"),t()()}if(a&2){let e=n.$implicit;c(),_("alt",T("P\xF3ster de ",e.peliculaNombre))("src","https://image.tmdb.org/t/p/w500"+e.posterPath,y),c(4),N(e.peliculaNombre),c(4),M("",e.calificacion,"/10"),c(4),M(" ",e.comentario),c(2),M("Fecha de la rese\xF1a: ",D(16,7,e.fecha,"medium"))}}function se(a,n){if(a&1&&(S(0),u(1,oe,21,10,"div",6),k()),a&2){let e=d().ngIf;c(),_("ngForOf",e)}}function ce(a,n){if(a&1&&(r(0,"div",4),u(1,se,2,1,"ng-container",5),t()),a&2){let e=n.ngIf;d();let s=F(7);c(),_("ngIf",e.length)("ngIfElse",s)}}function le(a,n){a&1&&(r(0,"p",10),o(1,"No has publicado ninguna rese\xF1a a\xFAn."),t())}function de(a,n){if(a&1){let e=x();r(0,"div",11)(1,"div",12)(2,"h3"),o(3,"Editar rese\xF1a"),t(),r(4,"textarea",13),C("ngModelChange",function(i){m(e);let l=d();return v(l.resenaEditando.comentario,i)||(l.resenaEditando.comentario=i),p(i)}),t(),r(5,"input",14),C("ngModelChange",function(i){m(e);let l=d();return v(l.resenaEditando.calificacion,i)||(l.resenaEditando.calificacion=i),p(i)}),t(),r(6,"div",15)(7,"button",9),g("click",function(){m(e);let i=d();return p(i.guardarEdicion())}),o(8,"Guardar"),t(),r(9,"button",9),g("click",function(){m(e);let i=d();return p(i.cancelarEdicion())}),o(10,"Cancelar"),t()()()()}if(a&2){let e=d();c(4),h("ngModel",e.resenaEditando.comentario),c(),h("ngModel",e.resenaEditando.calificacion)}}var ae=class a{constructor(n){this.router=n}firestore=f(X);auth=f(H);ngZone=f(I);resenas=[];resenas$;async ngOnInit(){let n=this.auth.currentUser;if(!n)return;let e=ee(this.firestore,"resenas"),s=ne(e,re("usuarioId","==",n.uid));this.resenas$=Y(s,{idField:"id"})}irAHome(){this.router.navigate(["/home"])}resenaEditando=null;editarResena(n){this.resenaEditando=w({},n)}cancelarEdicion(){this.resenaEditando=null}async guardarEdicion(){let n=b(this.firestore,"resenas",this.resenaEditando.id);await ie(n,{comentario:this.resenaEditando.comentario,calificacion:this.resenaEditando.calificacion}),this.resenaEditando=null}eliminarResena(n){if(!confirm("\xBFSeguro que quieres eliminar esta rese\xF1a?"))return;let e=b(this.firestore,"resenas",n);te(e)}static \u0275fac=function(e){return new(e||a)(O(j))};static \u0275cmp=P({type:a,selectors:[["app-misresenas"]],decls:9,vars:4,consts:[["sinResenas",""],[1,"volver",3,"click"],["class","resenas",4,"ngIf"],["class","modal",4,"ngIf"],[1,"resenas"],[4,"ngIf","ngIfElse"],["class","resena",4,"ngFor","ngForOf"],[1,"resena"],[3,"src","alt"],[3,"click"],[1,"empty"],[1,"modal"],[1,"modal-content"],["rows","4",3,"ngModelChange","ngModel"],["type","number","min","1","max","10",3,"ngModelChange","ngModel"],[1,"modal-actions"]],template:function(e,s){if(e&1){let i=x();r(0,"h2"),o(1,"Mis rese\xF1as"),t(),r(2,"button",1),g("click",function(){return m(i),p(s.irAHome())}),o(3,"Volver"),t(),u(4,ce,2,2,"div",2),E(5,"async"),u(6,le,2,0,"ng-template",null,0,A)(8,de,11,2,"div",3)}e&2&&(c(4),_("ngIf",R(5,2,s.resenas$)),c(4),_("ngIf",s.resenaEditando))},dependencies:[U,W,z,Q,L,G,Z,K,J,$,q,B],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}[_nghost-%COMP%]{display:block;padding:1rem}h2[_ngcontent-%COMP%]{text-align:center;margin:0 0 1rem;font-size:1.4rem}.volver[_ngcontent-%COMP%]{display:inline-block;margin-bottom:1rem;padding:.5rem .9rem;border:1px solid #ccc;border-radius:6px;background:#f7f7f7;cursor:pointer}.resenas[_ngcontent-%COMP%]{width:100%;max-width:700px;margin:0 auto}.resena[_ngcontent-%COMP%]{width:100%;padding:.75rem 0;border-bottom:1px solid #eaeaea}.resena[_ngcontent-%COMP%]:last-child{border-bottom:0}.resena[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;color:#333;overflow-wrap:anywhere;word-break:break-word}.resena[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;margin-top:.25rem;color:#666;font-size:.85rem}.resena[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;max-width:100%;height:auto}.empty[_ngcontent-%COMP%]{text-align:center;color:#666;font-style:italic;margin-top:1rem}@media (max-width: 480px){[_nghost-%COMP%]{padding:.75rem}h2[_ngcontent-%COMP%]{font-size:1.2rem}}"]})};export{ae as Misresenas};
